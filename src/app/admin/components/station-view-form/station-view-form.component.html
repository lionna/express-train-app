<div>
    <form class="card edit-container" [formGroup]="stationForm">
        <div class="map-container">
            <app-map-view
                [latitude]="stationForm.get(fields.LATITUDE)?.value"
                [longitude]="stationForm.get(fields.LONGITUDE)?.value"
                [city]="stationForm.get(fields.CITY)?.value"
                [connectedTo]="stationForm.get(fields.CONNECTED_TO)?.value"
                [stations]="stations"
            >
            </app-map-view>
        </div>
        <div class="form-container">
            <div class="form-group mb-2">
                <label for="city" class="block text-900 text-xl font-medium mb-2">{{
                    'STATION_PAGE.FIELDS.CITY_NAME.NAME' | translate
                }}</label>
                <input
                    [id]="fields.CITY"
                    [formControlName]="fields.CITY"
                    placeholder="{{ 'STATION_PAGE.FIELDS.CITY_NAME.PLACEHOLDER' | translate }}"
                    type="text"
                    class="ng-dirty w-full"
                    styleClass="w-full"
                    pInputText
                />

                @if (stationForm.get(fields.CITY); as rows) {
                    @if (!rows.pristine) {
                        @for (error of handleCityNameErrorMessages(rows.errors); track $index) {
                            <small class="p-error block mt-2"> {{ error | translate }} </small>
                        }
                    }
                }
            </div>

            <div class="form-group mb-2">
                <label for="latitude" class="block text-900 text-xl font-medium mb-2">
                    {{ 'STATION_PAGE.FIELDS.LATITUDE.NAME' | translate }}
                </label>
                <input
                    id="latitude"
                    type="number"
                    formControlName="latitude"
                    class="ng-dirty w-full"
                    styleClass="w-full"
                    pInputText
                />

                @if (stationForm.get(fields.LATITUDE); as rows) {
                    @if (!rows.pristine) {
                        @for (error of handleLatitudeErrorMessages(rows.errors); track $index) {
                            <small class="p-error block mt-2"> {{ error | translate }} </small>
                        }
                    }
                }
            </div>

            <div class="form-group mb-2">
                <label for="longitude" class="block text-900 text-xl font-medium mb-2">
                    {{ 'STATION_PAGE.FIELDS.LONGITUDE.NAME' | translate }}</label
                >
                <input
                    id="longitude"
                    type="number"
                    formControlName="longitude"
                    class="ng-dirty w-full"
                    styleClass="w-full"
                    pInputText
                />

                @if (stationForm.get(fields.LONGITUDE); as rows) {
                    @if (!rows.pristine) {
                        @for (error of handleLongitudeErrorMessages(rows.errors); track $index) {
                            <small class="p-error block mt-2"> {{ error | translate }} </small>
                        }
                    }
                }
            </div>

            <div class="form-group mb-5">
                <div class="text-900 text-xl font-medium mb-2">
                    <label for="connectedTo">
                        {{ 'STATION_PAGE.FIELDS.CONNECTED.NAME' | translate }}
                    </label>
                </div>

                <div formArrayName="connectedTo">
                    @for (control of connectedTo.controls; track $index) {
                        <div [formGroupName]="$index" class="flex align-items-center mb-2 gap-2">
                            <p-dropdown
                                formControlName="city"
                                optionLabel="city"
                                optionValue="city"
                                [options]="stations"
                                placeholder="{{ 'STATION_PAGE.FIELDS.CONNECTED.PLACEHOLDER' | translate }}"
                                class="w-full"
                                styleClass="w-full"
                                [disabled]="true"
                            />
                        </div>
                    }
                </div>
            </div>

            <div class="flex gap-2">
                <p-button
                    (click)="onCancelEdit()"
                    label="{{ 'BUTTONS.CANCEL' | translate }}"
                    severity="secondary"
                    icon="pi pi-times"
                />
            </div>
        </div>
    </form>
</div>
